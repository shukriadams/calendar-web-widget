/* calendar-web-widget | https://github.com/shukriadams/calendar-web-widget | License : GPLv2 */
"use strict";var Calendar=function(a){function b(){3===tb.toString().length&&(tb+=1900);var a="<div class='js-decMonth header-item prev'><div class='left-arrow'></div></div>";L&&(a+="<div class='header-item'><div class='js-calendar-web-widget-month-container calendar-web-widget-month-container'><div class='js-spanMonth'></div><div class='js-selectMonth selectMenu'></div></div></div>",a+="<div class='header-item'><div class='js-calendar-web-widget-year-container calendar-web-widget-year-container'><div class='js-spanYear'></div><div class='js-selectYear selectMenu'></div></div></div>"),a+="<div class='js-incMonth header-item next'><div class='right-arrow'></div></div>",B(".js-calendar-web-widget-header").innerHTML=a,P=B(".js-calendar-web-widget-container").style,L&&(Q=B(".js-selectMonth").style,R=B(".js-selectYear").style),Y=!1,Z=!1,H&&(B(".js-lblToday").innerHTML=lb+" <a title='"+kb+"' style='"+yb+"' class='js-focus-today' href='javascript:void(0)'>"+J[qb.getDay()-ib==-1?6:qb.getDay()-ib]+", "+rb+" "+I[sb].substring(0,3)+"	"+tb+"</a>"),nb=!0,c()}function c(){null!=P&&(P.visibility="hidden"),null!=Q&&(Q.visibility="hidden"),null!=R&&(R.visibility="hidden"),ub=!1}function d(a){return 10>a?"0"+a:a}function e(a,b,c){var e=eb;return e=e.replace("dd","<e>"),e=e.replace("d","<d>"),e=e.replace("<e>",d(a)),e=e.replace("<d>",a),e=e.replace("mmm","<o>"),e=e.replace("mm","<n>"),e=e.replace("m","<m>"),e=e.replace("<m>",b+1),e=e.replace("<n>",d(b+1)),e=e.replace("<o>",I[b]),e.replace("yyyy",c)}function f(){c();var a=e(U,S,T),b=cb.getAttribute("data-value");b!=a&&(cb.setAttribute("data-value",a),cb.hasAttribute("value")?cb.value=a:cb.innerHTML=a,G&&G(N,{date:a}))}function g(){$=setInterval("decMonth()",80)}function h(){$=setInterval("incMonth()",80)}function i(){S++,S>11&&(S=0,T++),w()}function j(){S--,0>S&&(S=11,T--),w()}function k(){if(t(),!Y){for(var a="",b=0;12>b;b++){var c=I[b];b==S&&(c="<B>"+c+"</B>"),a+="<tr><td class='js-month month dropdown-item' data-month='"+b+"' id='m"+b+"' style='cursor:pointer'>&nbsp;"+c+"&nbsp;</td></tr>"}B(".js-selectMonth").innerHTML="<table class='js-month-table dropdown month-dropdown'  cellspacing=0>"+a+"</table>";for(var d=B(".js-month"),e=0;e<d.length;e++){var f=d[e];A(f,"click",l)}var g=B(".js-month-table");A(g,"mouseover",function(){clearTimeout(ab)}),A(g,"mouseout",function(){clearTimeout(ab),ab=setTimeout(n,100),event.cancelBubble=!0}),Y=!0}}function l(a){a.target||(a.target=a.srcElement),Y=!1,S=parseInt(a.target.getAttribute("data-month")),w(),n(),a.cancelBubble=!0}function m(){k(),Q.visibility=pb||ob?"visible":"show"}function n(){Q.visibility="hidden",Y=!1}function o(){for(var a=0;7>a;a++){var b,c=a+fb+1;b=c==T?"&nbsp;<B>"+c+"</B>&nbsp;":"&nbsp;"+c+"&nbsp;",B(".js-y"+a).innerHTML=b}fb++}function p(){for(var a=0;7>a;a++){var b,c=a+fb-1;b=c==T?"&nbsp;<B>"+c+"</B>&nbsp;":"&nbsp;"+c+"&nbsp;",B(".js-y"+a).innerHTML=b}fb--}function q(a){T=parseInt(a+fb),Z=!1,w(),t()}function r(){if(n(),!Z){var a="<tr><td align='center' class='js-year-dec dropdown-item' style='cursor:pointer'>-</td></tr>",b=0;fb=T-3;for(var c=T-3;T+3>=c;c++){var d=c;c==T&&(d="<b>"+d+"</b>"),a+="<tr><td data-year='"+b+"' class='js-y"+b+" js-year dropdown-item' style='cursor:pointer'>&nbsp;"+d+"&nbsp;</td></tr>",b++}a+="<tr><td align='center' class='js-year-inc dropdown-item' style='cursor:pointer'>+</td></tr>",B(".js-selectYear").innerHTML="<table class='dropdown year-dropdown js-year-dropdown' cellspacing=0>"+a+"</table>";for(var e=B(".js-year"),c=0;c<e.length;c++)A(e[c],"click",s);Z=!0;var f=B(".js-year-inc"),g=B(".js-year-dropdown"),h=B(".js-year-dec");A(g,"mouseover",function(){clearTimeout(bb)}),A(g,"mouseout",function(){clearTimeout(bb),bb=setTimeout(t,100)}),A(f,"mouseout",function(){clearInterval(_)}),A(f,"mouseup",function(){clearInterval(_)}),A(f,"mousedown",function(){clearInterval(_),_=setInterval(o,30)}),A(h,"mouseout",function(){clearInterval($)}),A(h,"mouseup",function(){clearInterval($)}),A(h,"mousedown",function(){clearInterval($),$=setInterval(p,30)})}}function s(a){a.target||(a.target=a.srcElement);var b=a.target.getAttribute("data-year");b=parseInt(b),q(b),event.cancelBubble=!0}function t(){clearInterval($),clearTimeout(ab),clearInterval(_),clearTimeout(bb),R.visibility="hidden",Z=!1}function u(){r(),R.visibility=pb||ob?"visible":"show"}function v(a){var b,c=a.getFullYear(),d=a.getMonth()+1;b=K?a.getDate():a.getDate()+1;var e=Math.floor((14-d)/12),f=c+4800-e,g=d+12*e-3,h=Math.floor(f/4)-Math.floor(f/100)+Math.floor(f/400),i=b+Math.floor((153*g+2)/5)+365*f+h-32045,j=(i+31741-i%7)%146097%36524%1461,k=Math.floor(j/1460),l=(j-k)%365+k,m=Math.floor(l/7)+1;return m}function w(){var a,b,c,d=Array(31,0,31,30,31,30,31,31,30,31,30,31),e=new Date(T,S,1);1==S?(c=new Date(T,S+1,1),c=new Date(c-864e5),a=c.getDate()):a=d[S],b=e.getDay()-ib,0>b&&(b=6);var f="<table	class='innerTable' border=0><tr>";1==jb&&(f+="<td width=27><b>"+mb+"</b></td><td width=1 rowspan=7 bgcolor='#d0d0d0' style='padding:0px'></td>");for(var g=0;7>g;g++)f+="<td width='27' align='right'><B>"+J[g]+"</B></td>";f+="</tr><tr>",1==jb&&(f+="<td align=right>"+v(e)+"&nbsp;</td>");for(var g=1;b>=g;g++)f+="<td>&nbsp;</td>";for(var h=1;a>=h;h++){b++,f+="<td align=right>";var i=yb;h==X&&S==V&&T==W&&(i+=" "+zb);for(var j="",k=0;vb>k;k++)parseInt(wb[k].d)==h&&parseInt(wb[k].m)==S+1&&(0==parseInt(wb[k].y)||parseInt(wb[k].y)==T&&0!=parseInt(wb[k].y))&&(i+=" holiday",j+=""==j?wb[k].desc:"\n"+wb[k].desc);var l=/\"/g;j=j.replace(l,"&quot;"),f+=h==rb&&S==sb&&T==tb?'<b><a title="'+j+"\" class='"+i+" day today' href='javascript:void(0)'><font class='js-day' data-day='"+h+"'>&nbsp;"+h+"</font>&nbsp;</a></b>":b%7==-1*ib+1?'<a title="'+j+"\" class='"+i+" day sunday' href='javascript:void(0)'>&nbsp;<font class='js-day' data-day='"+h+"'>"+h+"</font>&nbsp;</a>":'<a title="'+j+"\" class='"+i+" day' href='javascript:void(0)'>&nbsp;<font class='js-day' data-day='"+h+"' >"+h+"&nbsp;</a>",f+="",(b+ib)%7==ib&&(f+="</tr><tr>",1==jb&&a>h&&(f+="<td align=right>"+v(new Date(T,S,h+1))+"&nbsp;</td>"))}B(".js-calendar-web-widget-content").innerHTML=f,L&&(B(".js-spanMonth").innerHTML="<div class='down-arrow'></div>"+I[S],B(".js-spanYear").innerHTML="<div class='down-arrow'></div>"+T);for(var m=B(".js-day"),g=0;g<m.length;g++)A(m[g],"click",x)}function x(a){a.target||(a.target=a.srcElement),U=a.target.getAttribute("data-day"),f()}function y(a,b,d){var e=0,f=0;if(nb){if("hidden"==P.visibility){cb=b,eb=d;var g=" ",h=eb.split(g);h.length<3&&(g="/",h=eb.split(g),h.length<3&&(g=".",h=eb.split(g),h.length<3&&(g="-",h=eb.split(g),h.length<3&&(g=""))));var i=0;if(""!=g){var j="";j=b.value?b.value.split(g):b.innerHTML.split(g);for(var k=0;3>k;k++)if("d"==h[k]||"dd"==h[k])U=parseInt(j[k],10),i++;else if("m"==h[k]||"mm"==h[k])S=parseInt(j[k],10)-1,i++;else if("yyyy"==h[k])T=parseInt(j[k],10),i++;else if("mmm"==h[k])for(var l=0;12>l;l++)j[k]==I[l]&&(S=l,i++)}(3!=i||isNaN(U)||isNaN(S)||isNaN(T))&&(U=rb,S=sb,T=tb),X=U,V=S,W=T;var m=a;do m=m.offsetParent,e+=m.offsetLeft,f+=m.offsetTop;while("BODY"!=m.tagName);P.left=-1==gb?a.offsetLeft+e+3:gb,P.top=-1==hb?a.offsetTop+f+a.offsetHeight+5:hb,w(1,S,T),P.visibility=pb||ob?"visible":"show",ub=!0}else c(),db!=a&&y(a,b,d);db=a}}function z(a){for(;;){if(!a.parentElement)return!1;if(a.parentElement==O)return!0;a=a.parentElement}}function A(a,b,c){a.addEventListener?a.addEventListener(b,c,!0):a.attachEvent&&a.attachEvent("on"+b,c)}function B(a,b){void 0===b&&(b=O);var c=b.querySelectorAll(a);return 0===c.length?null:1===c.length?c[0]:c}var C=a.el,D=a.host,E=void 0===a.inline?!1:a.inline,F=a.value,G=a.onValueChanged,H=void 0===a.showToday?!0:a.showToday,I=a.months||["January","February","March","April","May","June","July","August","September","October","November","December"],J=a.days||["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],K=void 0===a.startAtMonday?!0:a.startAtMonday,L=void 0===a.showMonthAndYearPickers?!1:a.showMonthAndYearPickers,M=a.format||"dd/mm/yyyy",N=this,O=document.createElement("div");O.className="calendar-web-widget",D?D.appendChild(O):C.parentNode.insertBefore(O,C.nextSibling);var P,Q,R,S,T,U,V,W,X,Y,Z,$,_,ab,bb,cb,db,eb,fb,gb=-1,hb=-1,ib=K?1:0,jb=0,kb="Go To Current Month",lb="Today is",mb="Wk",nb=!1,ob=document.all,pb=document.getElementById,qb=null;qb=F?new Date(Date.parse(F.replace(/-/g,"/"))):new Date;var rb=qb.getDate(),sb=qb.getMonth(),tb=qb.getYear(),ub=!1,vb=0,wb=[];if(pb){var xb="<div class='js-calendar-web-widget-container calendar-web-widget-container "+(E?"calendar-web-widget-container--inline":"calendar-web-widget-container--float")+"'><div class='js-calendar-web-widget-header calendar-web-widget-header'></div><div class='js-calendar-web-widget-content calendar-web-widget-content'></div>";H&&(xb+="<div class='today-footer js-lblToday'></div>"),xb+="</div>",O.innerHTML=xb}K&&(J.push(J[0]),J.splice(0,1));var yb=" anchor",zb=" bordered";b(),A(document,"keypress",function(){27==event.keyCode&&c()}),A(document,"click",function(a){a.target||(a.target=a.srcElement),a.target!=C&&ub&&!z(a.target)&&c()});var Ab=B(".js-focus-today");Ab&&A(Ab,"click",function(){S=sb,T=tb,w()}),L&&(A(B(".js-calendar-web-widget-year-container"),"click",function(){Z?t():u()}),A(B(".js-calendar-web-widget-month-container"),"click",function(){Y?n():m()}));var Bb=B(".js-decMonth");A(Bb,"click",j),A(Bb,"mouseout",function(){clearInterval($)}),A(Bb,"mousedown",function(){clearTimeout(ab),ab=setTimeout(g,500)}),A(Bb,"mouseup",function(){clearTimeout(ab),clearInterval($)});var Cb=B(".js-incMonth");A(Cb,"click",i),A(Cb,"mouseout",function(){clearInterval($)}),A(Cb,"mousedown",function(){clearTimeout(ab),ab=setTimeout(h,500)}),A(Cb,"mouseup",function(){clearTimeout(ab),clearInterval($)}),A(C,"click",function(){y(C,C,M)})};module.exports=Calendar;